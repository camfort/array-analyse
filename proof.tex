\section{Correctness}


\begin{theorem}[Soundness]
\[
S \equiv T
\quad
\Rightarrow
\quad
\interp{S} \equiv \interp{T}
\]
\end{theorem}

\begin{proof}
By induction on the equational theory $\equiv$, with respect
to the model $\interp{-}_n$.

\begin{description}
  \item[\textsc{Case F \texttt{+} F}:]
    \begin{align*}
      & \; \interp{\stenFwdSR{a}{d}{r} \; \texttt{+} \; \stenFwdSR{b}{d}{s}}_{n} \\
      \equiv & \; \interp{\stenFwdSR{a}{d}{r}}_{n} \cup \interp{\stenFwdSR{b}{d}{s}}_{n} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{1, \ldots, a\} \} \cup
                  \{\zeroEntry{d}{n} \mid r \} \cup
                  \{i\singleEntry{d}{n} \mid i \in \{1, \ldots, b\} \} \cup
                  \{\zeroEntry{d}{n} \mid s \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{1, \ldots, a\} \vee
                                             i \in \{1, \ldots, b\} \} \cup
                 \{\zeroEntry{d}{n} \mid r \} \cup \{\zeroEntry{d}{n} \mid s \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{1, \ldots, a \max b\} \} \cup
                  \{\zeroEntry{d}{n} \mid r \vee s \}\\
      \equiv & \; \interp{\stenFwdSR{a \, \max \, b}{d}{r \vee s}}_n \qed
    \end{align*}
  \item[\textsc{Case C \texttt{+} C}:]
    \begin{align*}
      & \; \interp{\stenCenSR{a}{d}{r} \; \texttt{+} \; \stenCenSR{b}{d}{s}}_{n} \\
      \equiv & \; \interp{\stenCenSR{a}{d}{r}}_{n} \cup \interp{\stenCenSR{b}{d}{s}}_{n} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\} \setminus 0 \} \cup
                  \{\zeroEntry{d}{n} \mid r \} \cup
                  \{i\singleEntry{d}{n} \mid i \in \{-b, \ldots, b\} \setminus 0 \} \cup
                 \{\zeroEntry{d}{n} \mid s \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\} \setminus 0 \vee
                                             i \in \{-b, \ldots, b\} \setminus 0 \} \cup
                 \{\zeroEntry{d}{n} \mid r \} \cup \{\zeroEntry{d}{n} \mid s \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-(a \max b), \ldots, a \max b\} \setminus 0 \} \cup
                  \{\zeroEntry{d}{n} \mid r \vee s \}\\
      \equiv & \; \interp{\stenCenSR{a \, \max \, b}{d}{r \vee s}}_n \qed
    \end{align*}
  \item[\textsc{Case B \texttt{+} B}:]
    \begin{align*}
      & \; \interp{\stenBwdSR{a}{d}{r} \; \texttt{+} \; \stenBwdSR{b}{d}{s}}_{n} \\
      \equiv & \; \interp{\stenBwdSR{a}{d}{r}}_{n} \cup \interp{\stenBwdSR{b}{d}{s}}_{n} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, -1\} \} \cup
                  \{\zeroEntry{d}{n} \mid r \} \cup
                  \{i\singleEntry{d}{n} \mid i \in \{-b, \ldots, -1\} \} \cup
                  \{\zeroEntry{d}{n} \mid s \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, -1\} \vee
                                             i \in \{-b, \ldots, -1\} \} \cup
                  \{\zeroEntry{d}{n} \mid r \} \cup \{\zeroEntry{d}{n} \mid s \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-(a \max b), \ldots, -1 \} \} \cup
                  \{\zeroEntry{d}{n} \mid r \vee s \}\\
      \equiv & \; \interp{\stenBwdSR{a \, \max \, b}{d}{r \vee s}}_n \qed
    \end{align*}
  \item[\textsc{Case C \texttt{+} F}: with side condition  $\;\;(a \geq b)$]
    \begin{align*}
      & \; \interp{\stenCenSR{a}{d}{r} \; \texttt{+} \; \stenFwdSR{b}{d}{s}}_{n} \\
      \equiv & \; \interp{\stenCenSR{a}{d}{r}}_{n} \cup \interp{\stenFwdSR{b}{d}{s}}_{n} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\} \setminus 0 \} \cup
                  \{\zeroEntry{d}{n} \mid r \} \cup
                  \{i\singleEntry{d}{n} \mid i \in \{1, \ldots, b\} \} \cup
                  \{\zeroEntry{d}{n} \mid s \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\} \setminus 0
                    \vee i \in \{1, \ldots, b\} \} \cup
                 \{\zeroEntry{d}{n} \mid r \} \cup \{\zeroEntry{d}{n} \mid s \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\}
               \setminus 0 \} \cup \{\zeroEntry{d}{n} \mid r \vee s \} \quad \text{, using }a \geq b \\
      \equiv & \; \interp{\stenCenSR{a}{d}{r \vee s}}_n \qed
    \end{align*}
  \item[\textsc{Case C \texttt{+} B}: with side condition  $\;\;(a \geq b)$]
    \begin{align*}
      & \; \interp{\stenCenSR{a}{d}{r} \; \texttt{+} \; \stenBwdSR{b}{d}{s}}_{n} \\
      \equiv & \; \interp{\stenCenSR{a}{d}{r}}_{n} \cup \interp{\stenBwdSR{b}{d}{s}}_{n} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\} \setminus 0 \} \cup
                  \{\zeroEntry{d}{n} \mid r \} \cup
                  \{i\singleEntry{d}{n} \mid i \in \{-b, \ldots, -1\} \} \cup
                  \{\zeroEntry{d}{n} \mid s \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\} \setminus 0
                    \vee i \in \{-b, \ldots, -1\} \} \cup
                 \{\zeroEntry{d}{n} \mid r \} \cup \{\zeroEntry{d}{n} \mid s \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\}
               \setminus 0 \} \cup \{ \zeroEntry{d}{n} \mid r \vee s \} \quad \text{, using }a \geq b \\
      \equiv & \; \interp{\stenCenSR{a}{d}{r \vee s}}_n \qed
    \end{align*}
  \item[\textsc{Case B \texttt{+} F}:]
    \begin{align*}
      & \; \interp{\stenBwdSR{a}{d}{r} \; \texttt{+} \; \stenFwdSR{a}{d}{r}}_{n} \\
      \equiv & \; \interp{\stenBwdSR{a}{d}{r}}_{n} \cup \interp{\stenFwdSR{a}{d}{s}}_{n} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, -1\} \} \cup
                  \{\zeroEntry{d}{n} \mid r \} \cup
                  \{i\singleEntry{d}{n} \mid i \in \{1, \ldots, a\} \} \cup
                  \{\zeroEntry{d}{n} \mid s \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, -1\}
                    \vee i \in \{1, \ldots, a\} \} \cup
                 \{\zeroEntry{d}{n} \mid r \} \cup \{\zeroEntry{d}{n} \mid s \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\} \setminus 0 \} \cup
                              \{\zeroEntry{d}{n} \mid r \vee s \} \\
      \equiv & \; \interp{\stenCenSR{a}{d}{r \vee s}}_n \qed
    \end{align*}
%
%
  \item[\textsc{Case P \texttt{+} F}:]
    \begin{align*}
      & \; \interp{\stenReflS{d} \; \texttt{+} \; \stenFwdSR{a}{d}{r}}_{n} \\
      \equiv & \; \interp{\stenReflS{d}}_{n} \cup \interp{\stenFwdSR{a}{d}{r}}_{n} \\
      \equiv & \; \{\zeroEntry{d}{n}\} \cup
                  \{i\singleEntry{d}{n} \mid i \in \{1, \ldots, a\} \} \cup
                  \{\zeroEntry{d}{n} \mid r \} \\
      \equiv & \; \{\zeroEntry{d}{n}\} \cup
                  \{i\singleEntry{d}{n} \mid i \in \{1, \ldots, a\} \} \\
      \equiv & \; \interp{\stenFwdS{a}{d}}_n \qed
    \end{align*}
%
%
  \item[\textsc{Case P \texttt{+} B}:]
    \begin{align*}
      & \; \interp{\stenReflS{d} \; \texttt{+} \; \stenBwdSR{a}{d}{r}}_{n} \\
      \equiv & \; \interp{\stenReflS{d}}_{n} \cup \interp{\stenBwdSR{a}{d}{r}}_{n} \\
      \equiv & \; \{\zeroEntry{d}{n}\} \cup
                  \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, -1\} \} \cup
                  \{\zeroEntry{d}{n} \mid r \} \\
      \equiv & \; \{\zeroEntry{d}{n}\} \cup
                  \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, -1\} \} \\
      \equiv & \; \interp{\stenBwdS{a}{d}}_n \qed
    \end{align*}

%
  \item[\textsc{Case P \texttt{+} C}:]
    \begin{align*}
      & \; \interp{\stenReflS{d} \; \texttt{+} \; \stenCenSR{a}{d}{r}}_{n} \\
      \equiv & \; \interp{\stenReflS{d}}_{n} \cup \interp{\stenCenSR{a}{d}{r}}_{n} \\
      \equiv & \; \{\zeroEntry{d}{n}\} \cup
                  \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\}
               \setminus 0 \} \cup
                  \{\zeroEntry{d}{n} \mid r \} \\
      \equiv & \; \{\zeroEntry{d}{n}\} \cup
                  \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\}
               \setminus 0 \} \\
      \equiv & \; \interp{\stenCenS{a}{d}}_n \qed
    \end{align*}
  \item[\textsc{Case POINT}]
   let $R$ be a region constant of dimension $d$ and $S$ be a region
   constant of dimension $d'$. \\

   By the definition of $\interp{-}$ and the syntactic sugar,
    then (*) $\interp{R}^{\irreflS} = \interp{R} \setminus
   \{\zeroEntry{d}{n}\}$ and similarly $\interp{S}^{\irreflS} =
   \interp{S} \setminus \{\zeroEntry{d'}{n}\}$
   \begin{align*}
    & \; \interp{(R \term{*} S^{\irreflS}) \term{+} (R^{\irreflS}
      \term{*} S)}_n \\
 \equiv & \; \interp{(R \term{*} S^{\irreflS})}_n \cup
          \interp{(R^{\irreflS} \term{*} S)}_n \\
 \equiv & \; (\interp{R}_n \otimes (\interp{S}_n \setminus
         \{\zeroEntry{d'}{n}\}))
   \cup ((\interp{R}_n \setminus \{\zeroEntry{d}{n}\}) \otimes
          \interp{S}_n) \\
(**) \equiv & \; (\{x \mid i \in \{1, \ldots, 2^n\},
                   (u, v) \in \interp{R}_n \times (\interp{S}_n \setminus
         \{\zeroEntry{d'}{n}\}),
                   x = (u \bowtie v)_i,
                   j \in (\effdims{\interp{R}_n}{n} \cup \effdims{\interp{S}_n \setminus
         \{\zeroEntry{d'}{n}\}}{n}),
                   x_j \neq \infty
                  \})
           \\
 \cup \; & (\{x \mid i \in \{1, \ldots, 2^n\},
                   (u, v) \in (\interp{R}_n \setminus
         \{\zeroEntry{d}{n}\}) \times \interp{S}_n),
                   x = (u \bowtie v)_i,
                   j \in (\effdims{\interp{R}_n \setminus
         \{\zeroEntry{d'}{n}\}}{n} \cup \effdims{\interp{S}_n}{n}),
                   x_j \neq \infty
                  \})
   \end{align*}
   By the meaning of $^{\irreflS}$ and (*) we then have that:
   \begin{align*}
    \effdims{\interp{R^\irreflS}}{n} = & \bigcup_{\interp{R} \setminus
   \{\zeroEntry{d}{n}\}}
    \{x \mid x \in \{1, \ldots, n\}, u_x \neq \infty\} \\
     = & \bigcup_{\interp{R}}  \{x \mid x \in \{1, \ldots, n\}, u_x \neq
       \infty\}  \setminus \{x \mid x \in \{1, \ldots, n\},
       (\zeroEntry{d}{n})_x \neq \infty\} \\
     = & \bigcup_{\interp{R}}  \{x \mid x \in \{1, \ldots, n\}, u_x \neq
       \infty\}  \setminus \{d\} \\
     = & \effdims{\interp{R}}{n} \setminus \{d\}
   \end{align*}
   similarly $\effdims{\interp{S^\irreflS}}{n} = \effdims{\interp{S}}{n}
   \setminus \{d'\}$.
   Continuing from (**), fold the two set-builders together:
  %
\begin{align*}
\equiv & \; (\{x \mid i \in \{1, \ldots, 2^n\},
                   (u, v) \in ((\interp{R}_n \times (\interp{S}_n \setminus
         \{\zeroEntry{d'}{n}\})) \cup (\interp{R}_n \setminus
         \{\zeroEntry{d}{n}\}) \times \interp{S}_n),
                   x = (u \bowtie v)_i, \\
 & \qquad         j \in (\effdims{\interp{R}}{n} \cup
         (\effdims{\interp{S}}{n} \setminus \{d'\}) \cup (\effdims{\interp{R}}{n} \setminus
         \{d'\}) \cup \effdims{\interp{S}}{n}),
                   x_j \neq \infty
                  \}
\end{align*}
%
Since $X \cup (X \setminus Y) = X$ for all sets, which also lifts to
Cartesian product, \ie{}, $(A \times (B \setminus C)) \cup ((A \setminus
D) \times B) = A \times B$ then:
%
\begin{align*}
\equiv \; & \; (\{x \mid i \in \{1, \ldots, 2^n\},
                   (u, v) \in ((\interp{R}_n \times (\interp{S}_n \setminus
         \{\zeroEntry{d'}{n}\})) \cup (\interp{R}_n \setminus
         \{\zeroEntry{d}{n}\}) \times \interp{S}_n),
                   x = (u \bowtie v)_i, \\
 & \qquad         j \in (\effdims{\interp{R}}{n} \cup \effdims{\interp{S}}{n}),
                   x_j \neq \infty
                  \} \\
\equiv \; & \; (\{x \mid i \in \{1, \ldots, 2^n\},
                   (u, v) \in (\interp{R}_n \times \interp{S}_n),
                   x = (u \bowtie v)_i, j \in (\effdims{\interp{R}}{n} \cup \effdims{\interp{S}}{n}),
                   x_j \neq \infty
                  \} \\
\equiv \; & \interp{R}_n \otimes \interp{S}_n \\
\equiv \; & \interp{R \term{*} S} \qed
\end{align*}

\item[\textsc{Case $*$dim}]

Let $R$ and $S$ be region constants (i.e., dimensionality
of 1) of the same dimension $d$, denoted in this equation $R^d$ and $S^d$.

\textbf{Lemma}: If $n=1$, $[a] \bowtie_1 [b] = [a b]$

\begin{align*}
 & \interp{R^d \ast S^d} \\
\equiv \; & \interp{R} \otimes_1 \interp{S} \\
\equiv \; & \interp{R^d} \cup \interp{S^d} \;\; \textit{by the above lemma} \\
\equiv \; & \interp{R^d \term{+} S^d}
\end{align*}

  \item[\textsc{Case +IDEM, +COMM, +ASSOC}:]
    Follows from respective properties of union of sets.
  \item[\textsc{Case *COMM}:] $\interp{r_1 \; \texttt{$\ast$} \; r_2}_n =
    \interp{r_1}_n \otimes \interp{r_2}_n$. Hence, $\texttt{$\ast$}$ is
    commutative iff $\otimes$ is commutative. Now let $\interp{r_1}_n$ and
    $\interp{r_2}_n$ be $S$ and $T$ respectively. Then from the definition of
    $\otimes$, we have $S \otimes T = \{ x \;|\; (s,t) \in S \times T,
    h \in \effdims{S}{n} \cup \effdims{T}{n}, x = (s \bowtie t)_k,
    k \in \{ 1, \ldots, 2^n \}, x_h \neq \infty \}$. Then to show commutativity
    of $\otimes$, it is enough to show for any vectors $s$ and $t$, any row
    vector of $s \bowtie t$ is also a row vector in the matrix $t \bowtie s$
    possibly with a different row index, since $\otimes$ collects row vectors of
    pairwise permutations. This in effect means $s \bowtie t$ is a permutation
    of $t \bowtie s$'s rows.

    Now let $\neg$ be a unary operator over logical matricies that revert $1$s
    to $0$s and vice versa. Then we can define pairwise permutation as
    $(s \bowtie t)_k = s \odot b_k + t \odot \neg b_k$. Now since $k$ ranges
    over all bit strings of length $n$, for all $k$ there is a $l$ such that
    $b_l = \neg b_k$. Hence for all $k$,

    \begin{align*}
      (s \bowtie t)_k &= s \odot b_k + t \odot \neg b_k \\
                      &= s \odot \neg b_l + t \odot \neg (\neg b_l) \\
                      &= t \odot \neg b_l + s \odot b_l \\
                      &= (t \bowtie s)_l
    \end{align*}

  \item[\textsc{Case *ASSOC}:]
    \begin{lemma}\label{lem:bowinf}
      Pairwise mutation, $u \bowtie v$, would produce $\infty$ column $j$ vector
      if both $u$ and $v$ are $\infty$ in vector.
    \end{lemma}

    \begin{proof}
      Let $b$ be the logical matrix where each column represents the binary
      string from $1$ to $2^n$. Now if the entire column is $\infty$, then
      independent of the row number $i$, column $j$ must evaluate to $\infty$.
      \begin{align*}
        (u \bowtie v)_{i,j} =& u_{j} \times b_{i,j} + v_{j} \times \neg b_{i,j}
                             & \mbox{by definition of $\bowtie$} \\
                            =& \infty \times b_{i,j} + \infty \times \neg b_{i,j}
                             & \mbox{Using the assumption in the lemma} \\
                            =& \infty
                             & \mbox{The value of $b_{i,j}$ no longer matters}
      \end{align*}
    \end{proof}

    \begin{lemma}\label{lem:tensordims}
      Constrained dimensions of tensor product of two models is the union of the
      constrained dimensions of models in question separately.
      \begin{align*}
        \effdims{U \otimes V}{n} = \effdims{U}{n} \cup \effdims{V}{n} \\
      \end{align*}
    \end{lemma}

    \begin{proof}
      \begin{align}
        \effdims{U \otimes V}{n} = &
          \bigcup_{x \in U \otimes V} \{ i \;|\; x_i \neq \infty \} \\
        = & \effdims{U}{n} \cup \effdims{V}{n} \\
          & \parbox{7cm}{By definition of $\otimes$, constrained dimensions of
                         $U$ and $V$ can be non-$\infty$ and by
                         Lemma~\ref{lem:bowinf} all other dimensions are
                         $\infty$.} \\
      \end{align}
    \end{proof}
%
    We have $\interp{r_1 \; \texttt{$\ast$} \;
    (r_2 \; \texttt{$\ast$} \; r_3)}_n = \interp{r_1}_n \otimes (\interp{r_2}_n
    \otimes \interp{r_3}_n)$ by definition. So we need to show $\otimes$ is
    associative. Now let $\interp{r_1}_n$, $\interp{r_2}_n$, and
    $\interp{r_3}_n$ be $R$, $S$, and $T$ respectively.

    Expanding the definition of $\otimes$,
%
    \begin{align*}
        & \interp{r_1}_n \otimes (\interp{r_2}_n \otimes \interp{r_3}_n) \\
      = & \bigg\{ x \; \bigg| \;
            \parbox{10cm}{
              $(r,st) \in R \times (S \otimes T),
               h \in \effdims{R}{n} \cup \effdims{S \otimes T}{n},$ \\
              $j \in \{ 1, \ldots, 2^n \},
                 x = (r \bowtie st)_j, x_h \neq \infty$
            } \bigg\} \\
      = & \bigg\{ x \; \bigg| \;
            \parbox{10cm}{
              $(r,st) \in R \times (S \otimes T),
               h \in \effdims{R}{n} \cup \effdims{S}{n} \cup \effdims{T}{n},$ \\
              $j \in \{ 1, \ldots, 2^n \},
                 x = (r \bowtie st)_j, x_h \neq \infty$
            } \bigg\} \\
        & \mbox{using Lemma~\ref{lem:tensordims} and expanding} \\
      = & \bigg\{ x \; \bigg| \;
            \parbox{10cm}{
              $(r,s,t) \in R \times (S \times T),
               h \in \effdims{R}{n} \cup \effdims{S}{n} \cup \effdims{T}{n},$ \\
              $i,j \in \{ 1, \ldots, 2^n \},
                y = (s \bowtie t)_i, x = (r \bowtie y)_j,
                x_h \neq \infty, y_h \neq \infty$
            } \bigg\} \\
        & \mbox{expanding definition of $\otimes$} \\
    \end{align*}
%
    If $\ast$ is associative, then an equivalent definition is:
    \begin{equation*}
          \bigg\{ x \; \bigg| \;
            \parbox{10cm}{
              $(r,s,t) \in R \times (S \times T),
               h \in \effdims{R}{n} \cup \effdims{S}{n} \cup \effdims{T}{n},$ \\
              $k,l \in \{ 1, \ldots, 2^n \},
                y = (r \bowtie s)_k, x = (y \bowtie t)_l,
                x_h \neq \infty, y_h \neq \infty$
            } \bigg\}
    \end{equation*}d
%
    For these two sets to be equivalent, it is enough to show that for any $r$,
    $s$, and $t$, for each $(i,j)$ pair there is a $(k,l)$ pair. When definition
    of $\bowtie$ is expanded, we then get the following equality:

    $$r \odot b_j + s \odot b_i \odot \neg b_j + t \odot \neg b_i \odot \neg b_j
    = r \odot b_k \odot b_l + s \odot \neg b_k \odot b_l + t \odot \neg b_l$$

    Hence, we get the following equations for logical row vectors:

    \begin{align}
      b_j & = b_k \odot b_l \\
      b_i \odot \neg b_j & = \neg b_k \odot b_l \\
      \neg b_i \odot \neg b_j & = \neg b_l
    \end{align}

    Observe that pairwise product on logical vectors corresponds to logical
    conjunction operation. In the following derivation $\wedge$ is used in place
    of $\odot$ for consistency. $\neg$ denotes logical negation of each element
    of the vector. Vector disjunction can be defined as $a \vee b = a + b - a
    \odot b$. Standard boolean algebra generalises over vectors.

    To see there is always a solution it is sufficient to show that the system
    of equations is consistent.

    \begin{align}
      b_l &= b_i \vee b_j & \mbox{negating $(3)$ and applying De Morgan's law} \\
      b_j &= b_k \wedge (b_i \vee b_j) & \mbox{substituting $(4)$ into $(1)$} \\
      b_i \wedge \neg b_j &= \neg b_k \wedge (b_i \vee b_j) & \mbox{substituting $(4)$
        into $(2)$} \\
      b_j \vee b_i \wedge \neg b_j &= b_k \wedge (b_i \vee b_j) \vee \neg b_k \wedge (b_i \vee b_j) & \mbox{disjunction of $(5)$ and $(6)$} \\
      b_i \vee b_j &= b_i \vee b_j & \mbox{algebraically simplifying (7)} \nonumber
    \end{align}



  \item[\textsc{Case DIST}:]
    \begin{lemma}\label{lem:effdims}
      Constrained dimensions distribute over set union.
      $$\effdims{U \cup V}{n} = \effdims{U}{n} \cup \effdims{V}{n}$$
    \end{lemma}

    \begin{proof}
      \begin{align*}
        \effdims{U \cup V}{n} &= \bigcup_{x \in U \cup V} \{ i \; | \; i \in \{1, \ldots, n\} \wedge x_i \neq \infty \} \\
        &= \bigcup_{x \in U} \{ i \; | \; i \in \{1, \ldots, n\}, x_i \neq \infty \} \cup
           \bigcup_{x \in V} \{ i \; | \; i \in \{1, \ldots, n\}m x_i \neq \infty \} \\
        &= \effdims{U}{n} \cup \effdims{V}{n} \\
      \end{align*}
    \end{proof}

    \begin{align*}
             & \interp{r_1 \; \ast \; (r_2 \; \texttt{+} \; r_3)}_n \\
      \equiv & \interp{r_1}_n \otimes \interp{r_2 \; \texttt{+} \; r_3}_n \\
      \equiv & \interp{r_1}_n \otimes (\interp{r_2}_n \cup \interp{r_3}_n) \\
      \equiv &
  \bigg\{x \; \bigg| \;
    \parbox{11cm}{$(u, v) \in \interp{r_1}_n \times (\interp{r_2}_n \cup \interp{r_3}_n),
                   j \in \effdims{\interp{r_1}_n}{n} \cup
                         \effdims{\interp{r_2}_n \cup
                         \interp{r_3}_n}{n},$ \\[0.1em]
                  $i \in \{1, \ldots, 2^n\},
                   x = (u \bowtie v)_i, x_j \neq \infty$
                  } \bigg\} \\
      \equiv &
  \Bigg\{x \; \Bigg| \;
    \parbox{11cm}{$(u, v) \in \interp{r_1}_n \times \interp{r_2}_n \vee (u, v) \in \interp{r_1}_n \times \interp{r_3}_n), \\
                   j \in \effdims{\interp{r_1}_n}{n} \cup
                          \effdims{\interp{r_2}_n}{n} \vee
                    j \in \effdims{\interp{r_1}_n}{n} \cup
                          \effdims{\interp{r_3}_n}{n},$ \\ [0.1em]
                  $i \in \{1, \ldots, 2^n\},
                   x = (u \bowtie v)_i, x_j \neq \infty$
                  } \Bigg\} \\
             & \mbox{using Lemma~\ref{lem:effdims} and distributivity of cartesian product over union.} \\
      \equiv &
  \bigg\{x \; \bigg| \;
    \parbox{9cm}{$(u, v) \in \interp{r_1}_n \times \interp{r_2}_n,
                  j \in \effdims{\interp{r_1}_n}{n} \cup
                        \effdims{\interp{r_2}_n}{n},$ \\
                 $i \in \{1, \ldots, 2^n\},
                  x = (u \bowtie v)_i, x_j \neq \infty$
                  } \bigg\} \cup \\
  & \bigg\{x \; \bigg| \;
    \parbox{9cm}{$(u, v) \in \interp{r_1}_n \times \interp{r_3}_n,
                  j \in \effdims{\interp{r_1}_n}{n} \cup
                        \effdims{\interp{r_3}_n}{n},$ \\
                 $i \in \{1, \ldots, 2^n\},
                  x = (u \bowtie v)_i, x_j \neq \infty$
                  } \bigg\} \\
      \equiv & (\interp{r_1}_n \otimes \interp{r_2}_n)
        \cup (\interp{r_1}_n \otimes \interp{r_3}_n) \\
      \equiv & \interp{r_1 \ast r_2}_n \cup \interp{r_1 \ast r_3}_n \\
      \equiv & \interp{r_1 \ast r_2 + r_1 \ast r_3}_n \\
    \end{align*}
\end{description}
\end{proof}

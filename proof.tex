\section{Correctness}


\begin{theorem}[Soundness]
\[
S \equiv T
\quad
\Rightarrow
\quad
\interp{S} \equiv \interp{T}
\]
\end{theorem}

\begin{proof}
We will prove different cases given in Figure~\ref{fig:equations} with respect
to the model given in Section~\ref{sec:semantics}.

\begin{description}
  \item[\textsc{Case F \texttt{+} F}:]
    \begin{align*}
      & \; \interp{\stenFwdS{a}{d} \; \texttt{+} \; \stenFwdS{b}{d}}_{n} \\
      \equiv & \; \interp{\stenFwdS{a}{d}}_{n} \; \cup \; \interp{\stenFwdS{b}{d}}_{n} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{0, \ldots, a\} \} \; \cup \;
                  \{i\singleEntry{d}{n} \mid i \in \{0, \ldots, b\} \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{0, \ldots, a\}
                    \vee i \in \{0, \ldots, b\} \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{0, \ldots, a \max b\} \} \\
      \equiv & \; \interp{\stenFwdS{a \, \max \, b}{d}}_n \\
    \end{align*}
  \item[\textsc{Case C \texttt{+} C}:]
    \begin{align*}
      & \; \interp{\stenCenS{a}{d} \; \texttt{+} \; \stenCenS{b}{d}}_{n} \\
      \equiv & \; \interp{\stenCenS{a}{d}}_{n} \; \cup \; \interp{\stenCenS{b}{d}}_{n} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\} \} \; \cup \;
                  \{i\singleEntry{d}{n} \mid i \in \{-b, \ldots, b\} \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\}
                    \vee i \in \{-b, \ldots, b\} \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{- (a \max b), \ldots, a \max b\} \} \\
      \equiv & \; \interp{\stenCenS{a \, \max \, b}{d}}_n \\
    \end{align*}
  \item[\textsc{Case B \texttt{+} B}:]
    \begin{align*}
      & \; \interp{\stenBwdS{a}{d} \; \texttt{+} \; \stenBwdS{b}{d}}_{n} \\
      \equiv & \; \interp{\stenBwdS{a}{d}}_{n} \; \cup \; \interp{\stenBwdS{b}{d}}_{n} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, 0\} \} \; \cup \;
                  \{i\singleEntry{d}{n} \mid i \in \{-b, \ldots, 0\} \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, 0\}
                    \vee i \in \{-b, \ldots, 0\} \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{- (a \max b), \ldots, 0\} \} \\
      \equiv & \; \interp{\stenBwdS{a \, \max \, b}{d}}_n \\
    \end{align*}
  \item[\textsc{Case C \texttt{+} F}:]
    \begin{align*}
      & \; \interp{\stenCenS{a}{d} \; \texttt{+} \; \stenFwdS{b}{d}}_{n} \\
      \equiv & \; \interp{\stenCenS{a}{d}}_{n} \; \cup \; \interp{\stenFwdS{b}{d}}_{n} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\} \} \; \cup \;
                  \{i\singleEntry{d}{n} \mid i \in \{0, \ldots, b\} \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\}
                    \vee i \in \{0, \ldots, b\} \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\} \} \quad \text{, using }a \geq b \\
      \equiv & \; \interp{\stenCenS{a}{d}}_n \\
    \end{align*}
  \item[\textsc{Case C \texttt{+} B}:]
    \begin{align*}
      & \; \interp{\stenCenS{a}{d} \; \texttt{+} \; \stenBwdS{b}{d}}_{n} \\
      \equiv & \; \interp{\stenCenS{a}{d}}_{n} \; \cup \; \interp{\stenBwdS{b}{d}}_{n} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\} \} \; \cup \;
                  \{i\singleEntry{d}{n} \mid i \in \{-b, \ldots, 0\} \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\}
                    \vee i \in \{-b, \ldots, 0\} \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\} \} \quad \text{, using }a \geq b \\
      \equiv & \; \interp{\stenCenS{a}{d}}_n \\
    \end{align*}
  \item[\textsc{Case B \texttt{+} F}:]
    \begin{align*}
      & \; \interp{\stenBwdS{a}{d} \; \texttt{+} \; \stenFwdS{a}{d}}_{n} \\
      \equiv & \; \interp{\stenBwdS{a}{d}}_{n} \; \cup \; \interp{\stenFwdS{a}{d}}_{n} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, 0\} \} \; \cup \;
                  \{i\singleEntry{d}{n} \mid i \in \{0, \ldots, a\} \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, 0\}
                    \vee i \in \{0, \ldots, a\} \} \\
      \equiv & \; \{i\singleEntry{d}{n} \mid i \in \{-a, \ldots, a\} \} \\
      \equiv & \; \interp{\stenCenS{a}{d}}_n \\
    \end{align*}
  \item[\textsc{Case +COMM}:] Follows from commutativity of union of sets.
  \item[\textsc{Case +ASSOC}:] Follows from associativity of union of sets.
  \item[\textsc{Case *COMM}:] $\interp{r_1 \; \texttt{$\ast$} \; r_2}_n =
    \interp{r_1}_n \otimes \interp{r_2}_n$. Hence, $\texttt{$\ast$}$ is
    commutative iff $\otimes$ is commutative. Now let $\interp{r_1}_n$ and
    $\interp{r_2}_n$ be $S$ and $T$ respectively. Then from the definition of
    $\otimes$, we have $S \otimes T = \{ (s \bowtie t)_i \mid i \in
    \{ 0, \ldots, 2^n-1 \}, (s,t) \in S \times T \}$. Then to show
    commutativity of $\otimes$, it is enough to show any row vector of $s
    \bowtie t$ is also a row vector in the matrix $t \bowtie s$ possibly with a
    different row index.

    Now let $\neg$ be a unary operator over logical matricies that revert $1$s
    to $0$s and vice versa. Then we can define pairwise permutation as
    $(t \bowtie s)_i = t \odot b_i + s \odot \neg b_i$. Now since $i$ ranges
    over all bit strings of length $n$, for all $i$ there is a $j$ such that
    $b_j = \neg b_i$. Hence for all $i$,

    \begin{align*}
      (t \bowtie s)_i &= t \odot b_i + s \odot \neg b_i \\
                      &= t \odot \neg b_j + s \odot \neg (\neg b_j) \\
                      &= s \odot \neg b_j + t \odot b_j \\
                      &= (s \bowtie t)_j
    \end{align*}

  \item[\textsc{Case *ASSOC}:]
  \item[\textsc{Case DIST}:]
\end{description}
\end{proof}
